{
	email {$CADDY_EMAIL:ops@example.com}
}

{$APP_DOMAIN:app.localhost} {
	reverse_proxy frontend:80
}

{$API_DOMAIN:api.localhost} {
	reverse_proxy backend:3001
}

{$S3_DOMAIN:s3.localhost} {
	reverse_proxy minio:9000
}

{$SUPABASE_DOMAIN:supabase.localhost} {
	reverse_proxy supabase-kong:8000
}

:80 {
	@api path /api/* /ws/* /ws/v1/*
	handle @api {
		reverse_proxy backend:3001
	}

	handle_path /s3/* {
		reverse_proxy minio:9000
	}

	handle_path /minio/* {
		reverse_proxy minio:9000
	}

	@supabase path /auth/* /rest/* /storage/*
	handle @supabase {
		reverse_proxy supabase-kong:8000
	}

	handle {
		reverse_proxy frontend:80
	}
}
