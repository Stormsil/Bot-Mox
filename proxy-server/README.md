# IPQualityScore Proxy Server

–õ–æ–∫–∞–ª—å–Ω—ã–π Express.js –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è IPQualityScore API. –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É CORS –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 16+
- npm –∏–ª–∏ yarn
- Firebase —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å–µ—Ä–≤–µ—Ä–∞:
```bash
cd proxy-server
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp .env.example .env
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API –∫–ª—é—á–∞

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–±: Firebase Realtime Database (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç API –∫–ª—é—á –∏–∑ Firebase Realtime Database –ø–æ –ø—É—Ç–∏:
```
settings/api_keys/ipqs/api_key
```

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å Firebase —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏:
```
../Assets/firebase-key.json
```

–ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
FIREBASE_SERVICE_ACCOUNT_PATH=/path/to/firebase-key.json
FIREBASE_DATABASE_URL=https://your-project.firebaseio.com/
```

### –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: .env —Ñ–∞–π–ª

–ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ Firebase, —Å–µ—Ä–≤–µ—Ä –ø–æ–ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ –µ–≥–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
IPQS_API_KEY=your_ipqs_api_key_here
```

### –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω

–ï—Å–ª–∏ API –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏ –≤ Firebase, –Ω–∏ –≤ .env:
- –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/status` –ø–æ–∫–∞–∂–µ—Ç `"configured": false`
- –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/check-ip` –≤–µ—Ä–Ω—É—Ç –æ—à–∏–±–∫—É 503 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –∫–ª—é—á–∞

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–æ–µ–∫—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
npm run dev
```
–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –∏ proxy-server, –∏ Vite dev server –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ proxy-server:
```bash
npm start
```

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π):
```bash
npm run dev
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3001`

## üì° API Endpoints

### GET `/api/status`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ IPQS.

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T12:00:00.000Z",
  "firebase_initialized": true,
  "ipqs": {
    "enabled": true,
    "configured": true
  }
}
```

### POST `/api/check-ip`
–ü—Ä–æ–≤–µ—Ä–∫–∞ IP –∞–¥—Ä–µ—Å–∞ —á–µ—Ä–µ–∑ IPQualityScore API.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "ip": "8.8.8.8"
}
```

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "data": {
    "success": true,
    "fraud_score": 0,
    "country_code": "US",
    "region": "California",
    "city": "Mountain View",
    "isp": "Google LLC",
    "vpn": false,
    "proxy": false,
    "tor": false,
    ...
  }
}
```

**–û—Ç–≤–µ—Ç (API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω):**
```json
{
  "success": false,
  "error": "IPQS API key not configured. Please add API key to Firebase Realtime Database at settings/api_keys/ipqs/api_key or set IPQS_API_KEY in .env"
}
```

### POST `/api/check-ip-batch`
–ü–∞–∫–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö IP –∞–¥—Ä–µ—Å–æ–≤ (–º–∞–∫—Å–∏–º—É–º 10).

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "ips": ["8.8.8.8", "1.1.1.1"]
}
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

–í `bot-mox/src/services/ipqsService.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback:
1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (`http://localhost:3001`)
2. –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ–Ω –∑–∞–ø—É—â–µ–Ω –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

## üìù –õ–æ–≥–∏

–°–µ—Ä–≤–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ùå –û—à–∏–±–∫–∏
- üîç –ü—Ä–æ–≤–µ—Ä–∫–∏ IP

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- API –∫–ª—é—á –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è `localhost:5173` (Vite dev server)
- –í–∞–ª–∏–¥–∞—Ü–∏—è IP –∞–¥—Ä–µ—Å–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ IPQS
- –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (10 —Å–µ–∫—É–Ω–¥)

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 3001 —Å–≤–æ–±–æ–¥–µ–Ω:
```bash
# Windows
netstat -ano | findstr :3001

# Linux/Mac
lsof -i :3001
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase:
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls ../Assets/firebase-key.json
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á IPQS:
```bash
# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
curl -X POST http://localhost:3001/api/check-ip \
  -H "Content-Type: application/json" \
  -d '{"ip": "8.8.8.8"}'
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞:
```bash
curl http://localhost:3001/api/status
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
