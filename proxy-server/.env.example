# IPQualityScore Proxy Server Configuration

# Server Configuration
PORT=3001

# Data backend mode
# rtdb     = current Firebase Realtime Database mode (default)
# supabase = Supabase/Postgres mode (currently enabled for settings/storage_policy path)
DATA_BACKEND=rtdb

# CORS Configuration (comma-separated list of allowed origins)
CORS_ORIGIN=http://localhost:5173,http://127.0.0.1:5173

# Internal API tokens (required for /api/v1/*)
# Infra token is required for protected routes under /api/v1/infra/*
INTERNAL_API_TOKEN=change-me-api-token
INTERNAL_INFRA_TOKEN=change-me-infra-token
# For local dev only. When false, server will NOT auto-fallback to change-me tokens.
ALLOW_INSECURE_DEV_TOKENS=false

# Default tenant context (used by internal tokens / missing tenant claim)
DEFAULT_TENANT_ID=default

# Rate-limit policy for API routes
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX=500

# SSH policy
# false = only allow allowlisted commands for /api/v1/infra/ssh/exec
# true  = bypass allowlist (emergency internal diagnostics only)
SSH_EXEC_ALLOW_UNSAFE=false

# Execution lease token configuration (required for /api/v1/license/lease)
LICENSE_LEASE_SECRET=change-me-very-long-random-secret
# 60..3600 seconds, recommended: 300 (5 min)
LICENSE_LEASE_TTL_SECONDS=300

# IPQualityScore API Key (fallback if Firebase is not configured)
IPQS_API_KEY=your_ipqs_api_key_here

# Firebase Configuration (optional - for reading API key from Firebase and token verification)
# Path to your Firebase service account JSON file
# Supported examples:
# - ../Assets/firebase-key.json
# - ../firebase-key.json
FIREBASE_SERVICE_ACCOUNT_PATH=../firebase-key.json

# Firebase Realtime Database URL
FIREBASE_DATABASE_URL=https://your-project-default-rtdb.region.firebasedatabase.app
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_DATABASE_REGION=europe-west1

# Supabase service credentials (required when DATA_BACKEND=supabase)
SUPABASE_URL=http://127.0.0.1:54321
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
REQUIRE_SUPABASE_READY=false

# S3/MinIO artifacts storage
S3_ENDPOINT=http://127.0.0.1:9000
S3_REGION=us-east-1
S3_BUCKET_ARTIFACTS=botmox-artifacts
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=change-me-minio-root
S3_FORCE_PATH_STYLE=true
S3_PRESIGN_TTL_SECONDS=300
REQUIRE_S3_READY=false
READINESS_PROBE_TIMEOUT_MS=2000

# Proxmox fallback settings (used when Firebase settings are absent)
PROXMOX_URL=https://127.0.0.1:8006
PROXMOX_USERNAME=root
PROXMOX_PASSWORD=
PROXMOX_NODE=h1
PROXMOX_AUTO_LOGIN=true
PROXMOX_UI_TARGET=https://127.0.0.1:8006

# SSH fallback settings (used when Firebase settings are absent)
SSH_HOST=127.0.0.1
SSH_PORT=22
SSH_USERNAME=root
SSH_PASSWORD=
SSH_USE_KEY_AUTH=true
SSH_PRIVATE_KEY_PATH=

# Optional fallback UI service settings (used when Firebase settings are absent)
TINYFM_URL=http://127.0.0.1:8080/index.php?p=
TINYFM_UI_TARGET=http://127.0.0.1:8080
TINYFM_AUTO_LOGIN=true
TINYFM_USERNAME=
TINYFM_PASSWORD=

SYNCTHING_URL=https://127.0.0.1:8384/
SYNCTHING_UI_TARGET=https://127.0.0.1:8384
SYNCTHING_AUTO_LOGIN=true
SYNCTHING_USERNAME=
SYNCTHING_PASSWORD=
