# IPQualityScore Proxy Server Configuration

# Server Configuration
PORT=3001

# Data backend mode
# supabase = Supabase/Postgres mode (default and runtime-only)
DATA_BACKEND=supabase

# CORS Configuration (comma-separated list of allowed origins)
CORS_ORIGIN=http://localhost:5173,http://127.0.0.1:5173

# Default tenant context (used when token has no tenant claim)
DEFAULT_TENANT_ID=default

# Rate-limit policy for API routes
API_RATE_LIMIT_WINDOW_MS=900000
API_RATE_LIMIT_MAX=10000

# SSH policy
# false = only allow allowlisted commands for /api/v1/infra/ssh/exec
# true  = bypass allowlist (emergency internal diagnostics only)
SSH_EXEC_ALLOW_UNSAFE=false

# Execution lease token configuration (required for /api/v1/license/lease)
LICENSE_LEASE_SECRET=change-me-very-long-random-secret
# 60..3600 seconds, recommended: 300 (5 min)
LICENSE_LEASE_TTL_SECONDS=300
# Agent auth tokens (issued on /api/v1/agents/register)
# If empty, falls back to LICENSE_LEASE_SECRET.
AGENT_AUTH_SECRET=
# 300..15552000 seconds (5 min..180 days), default: 30 days.
AGENT_TOKEN_TTL_SECONDS=2592000
# Optional public API base URL used to build copy/paste pairing links.
# Example: https://api.example.com
AGENT_PAIRING_PUBLIC_URL=

# IPQualityScore API Key (fallback if not set in app settings)
IPQS_API_KEY=your_ipqs_api_key_here

# Supabase service credentials (required when DATA_BACKEND=supabase)
SUPABASE_URL=http://127.0.0.1:54321
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
# Supabase Auth admin allowlist (optional, comma-separated)
# Use this to grant infra/admin roles to selected operators when using Supabase Auth tokens.
SUPABASE_ADMIN_EMAILS=
SUPABASE_ADMIN_USER_IDS=
REQUIRE_SUPABASE_READY=false

# S3/MinIO artifacts storage
# All four values below are required together if S3 is enabled.
S3_ENDPOINT=http://127.0.0.1:9000
S3_REGION=us-east-1
S3_BUCKET_ARTIFACTS=botmox-artifacts
S3_BUCKET_THEME_ASSETS=botmox-theme-assets
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=change-me-minio-root
S3_FORCE_PATH_STYLE=true
S3_PRESIGN_TTL_SECONDS=300
S3_BUCKET_PROVISIONING=botmox-provisioning
REQUIRE_S3_READY=false

# Provisioning token configuration
PROVISION_TOKEN_SECRET=
PROVISION_TOKEN_TTL_DAYS=30
READINESS_PROBE_TIMEOUT_MS=2000

# Proxmox fallback settings (used when app settings are absent)
PROXMOX_URL=https://127.0.0.1:8006
PROXMOX_USERNAME=root
PROXMOX_PASSWORD=
PROXMOX_NODE=h1
PROXMOX_AUTO_LOGIN=true
PROXMOX_UI_TARGET=https://127.0.0.1:8006

# SSH fallback settings (used when app settings are absent)
SSH_HOST=127.0.0.1
SSH_PORT=22
SSH_USERNAME=root
SSH_PASSWORD=
SSH_USE_KEY_AUTH=true
SSH_PRIVATE_KEY_PATH=

# Optional fallback UI service settings (used when app settings are absent)
TINYFM_URL=http://127.0.0.1:8080/index.php?p=
TINYFM_UI_TARGET=http://127.0.0.1:8080
TINYFM_AUTO_LOGIN=true
TINYFM_USERNAME=
TINYFM_PASSWORD=

SYNCTHING_URL=https://127.0.0.1:8384/
SYNCTHING_UI_TARGET=https://127.0.0.1:8384
SYNCTHING_AUTO_LOGIN=true
SYNCTHING_USERNAME=
SYNCTHING_PASSWORD=
