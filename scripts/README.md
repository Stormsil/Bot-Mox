# Database Cleanup Scripts

## cleanup-database.js

–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏ —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Firebase.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:

1. **–ú–∏–≥—Ä–∞—Ü–∏—è schedule v1 ‚Üí v2**
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–ø–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞) –≤ –Ω–æ–≤—ã–π (v2 —Å —Å–µ—Å—Å–∏—è–º–∏)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö v2 —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π
   - –°–æ–∑–¥–∞–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –±–æ—Ç–æ–≤ –±–µ–∑ schedule

2. **–£–¥–∞–ª–µ–Ω–∏–µ –∞—Ä—Ö–∞–∏—á–Ω—ã—Ö –ø–æ–ª–µ–π**
   - `old_schedule`
   - `schedule_v1`
   - `temp_schedule`
   - `_migration_backup`

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (id, project_id, status, character)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É schedule.days

### –ó–∞–ø—É—Å–∫:

```bash
cd scripts
node cleanup-database.js
```

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ Firebase!

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```
üìä Found X bots

üìã Processing bot: <bot_id>
  üîÑ Migrating schedule v1 ‚Üí v2
  ‚úÖ Schedule v2 is valid
  üóëÔ∏è  Removing deprecated field: old_schedule

üíæ Applying X updates...
‚úÖ Database cleanup completed successfully!

üìà Statistics:
  - Total bots: X
  - Bots updated: Y
  - Bots unchanged: Z
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- –°–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç/—É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–µ —É–¥–∞–ª—è–µ—Ç –±–æ—Ç–æ–≤
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Firebase update() (–∞—Ç–æ–º–∞—Ä–Ω–æ)
- –°—Ç–∞—Ä—ã–µ schedule –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è, –∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- –ï—Å–ª–∏ schedule —É–∂–µ v2 –∏ –≤–∞–ª–∏–¥–µ–Ω - –æ–Ω –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **Permission denied** - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å
2. **Network error** - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
3. **Invalid data** - –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –±–æ—Ç–æ–≤ —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—à–∏–±–∫–∞–º–∏